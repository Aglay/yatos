    SECTION .text

global irq_num_0
global irq_num_1
global irq_num_2
global irq_num_3
global irq_num_4
global irq_num_5
global irq_num_6
global irq_num_7
global irq_num_8
global irq_num_9
global irq_num_10
global irq_num_11
global irq_num_12
global irq_num_13
global irq_num_14
global irq_num_15
global irq_num_16
global irq_num_17
global irq_num_18
global irq_num_19
global irq_num_20
global irq_num_21
global irq_num_22
global irq_num_23
global irq_num_24
global irq_num_25
global irq_num_26
global irq_num_27
global irq_num_28
global irq_num_29
global irq_num_30
global irq_num_31
global irq_num_32
global irq_num_33
global irq_num_34
global irq_num_35
global irq_num_36
global irq_num_37
global irq_num_38
global irq_num_39
global irq_num_40
global irq_num_41
global irq_num_42
global irq_num_43
global irq_num_44
global irq_num_45
global irq_num_46
global irq_num_47
global irq_num_48
global irq_num_49
global irq_num_50
global irq_num_51
global irq_num_52
global irq_num_53
global irq_num_54
global irq_num_55
global irq_num_56
global irq_num_57
global irq_num_58
global irq_num_59
global irq_num_60
global irq_num_61
global irq_num_62
global irq_num_63
global irq_num_64
global irq_num_65
global irq_num_66
global irq_num_67
global irq_num_68
global irq_num_69
global irq_num_70
global irq_num_71
global irq_num_72
global irq_num_73
global irq_num_74
global irq_num_75
global irq_num_76
global irq_num_77
global irq_num_78
global irq_num_79
global irq_num_80
global irq_num_81
global irq_num_82
global irq_num_83
global irq_num_84
global irq_num_85
global irq_num_86
global irq_num_87
global irq_num_88
global irq_num_89
global irq_num_90
global irq_num_91
global irq_num_92
global irq_num_93
global irq_num_94
global irq_num_95
global irq_num_96
global irq_num_97
global irq_num_98
global irq_num_99
global irq_num_100
global irq_num_101
global irq_num_102
global irq_num_103
global irq_num_104
global irq_num_105
global irq_num_106
global irq_num_107
global irq_num_108
global irq_num_109
global irq_num_110
global irq_num_111
global irq_num_112
global irq_num_113
global irq_num_114
global irq_num_115
global irq_num_116
global irq_num_117
global irq_num_118
global irq_num_119
global irq_num_120
global irq_num_121
global irq_num_122
global irq_num_123
global irq_num_124
global irq_num_125
global irq_num_126
global irq_num_127
global irq_num_128
global irq_num_129
global irq_num_130
global irq_num_131
global irq_num_132
global irq_num_133
global irq_num_134
global irq_num_135
global irq_num_136
global irq_num_137
global irq_num_138
global irq_num_139
global irq_num_140
global irq_num_141
global irq_num_142
global irq_num_143
global irq_num_144
global irq_num_145
global irq_num_146
global irq_num_147
global irq_num_148
global irq_num_149
global irq_num_150
global irq_num_151
global irq_num_152
global irq_num_153
global irq_num_154
global irq_num_155
global irq_num_156
global irq_num_157
global irq_num_158
global irq_num_159
global irq_num_160
global irq_num_161
global irq_num_162
global irq_num_163
global irq_num_164
global irq_num_165
global irq_num_166
global irq_num_167
global irq_num_168
global irq_num_169
global irq_num_170
global irq_num_171
global irq_num_172
global irq_num_173
global irq_num_174
global irq_num_175
global irq_num_176
global irq_num_177
global irq_num_178
global irq_num_179
global irq_num_180
global irq_num_181
global irq_num_182
global irq_num_183
global irq_num_184
global irq_num_185
global irq_num_186
global irq_num_187
global irq_num_188
global irq_num_189
global irq_num_190
global irq_num_191
global irq_num_192
global irq_num_193
global irq_num_194
global irq_num_195
global irq_num_196
global irq_num_197
global irq_num_198
global irq_num_199
global irq_num_200
global irq_num_201
global irq_num_202
global irq_num_203
global irq_num_204
global irq_num_205
global irq_num_206
global irq_num_207
global irq_num_208
global irq_num_209
global irq_num_210
global irq_num_211
global irq_num_212
global irq_num_213
global irq_num_214
global irq_num_215
global irq_num_216
global irq_num_217
global irq_num_218
global irq_num_219
global irq_num_220
global irq_num_221
global irq_num_222
global irq_num_223
global irq_num_224
global irq_num_225
global irq_num_226
global irq_num_227
global irq_num_228
global irq_num_229
global irq_num_230
global irq_num_231
global irq_num_232
global irq_num_233
global irq_num_234
global irq_num_235
global irq_num_236
global irq_num_237
global irq_num_238
global irq_num_239
global irq_num_240
global irq_num_241
global irq_num_242
global irq_num_243
global irq_num_244
global irq_num_245
global irq_num_246
global irq_num_247
global irq_num_248
global irq_num_249
global irq_num_250
global irq_num_251
global irq_num_252
global irq_num_253
global irq_num_254
global irq_num_255
global arch_irq_disable
global arch_irq_enable

extern irq_vectors

irq_test:
    int 0x80
    ret

arch_irq_enable:
    sti
    ret
arch_irq_disable:
    cli
    ret
%macro SAVE_REGS 0
    push es
    push ds
    push eax
    push ebp
    push edi
    push esi
    push edx
    push ecx
    push ebx
%endmacro

%macro RESTOR_REGS 0
    pop ebx
    pop ecx
    pop edx
    pop esi
    pop edi
    pop ebp
    pop eax
    pop ds
    pop es
%endmacro


%macro CALL_VECTOR_HANDLER 1
    mov eax, irq_vectors
    mov ebx, %1
    shl ebx, 2
    add eax, ebx
    mov ebx,[eax]
    call ebx
%endmacro

%macro IRQ_ECODE_HANDLER 1
    push %1
    SAVE_REGS
    CALL_VECTOR_HANDLER %1
    RESTOR_REGS
    add esp, 4
    iretd
%endmacro

%macro IRQ_NO_ECODE_HANDLER 1
    push 0
    push %1
    SAVE_REGS
    CALL_VECTOR_HANDLER %1
    RESTOR_REGS
    add esp, 8
    iretd
%endmacro

irq_num_0:   IRQ_NO_ECODE_HANDLER 0
irq_num_1:   IRQ_NO_ECODE_HANDLER 1
irq_num_2:   IRQ_NO_ECODE_HANDLER 2
irq_num_3:   IRQ_NO_ECODE_HANDLER 3
irq_num_4:   IRQ_NO_ECODE_HANDLER 4
irq_num_5:   IRQ_NO_ECODE_HANDLER 5
irq_num_6:   IRQ_NO_ECODE_HANDLER 6
irq_num_7:   IRQ_NO_ECODE_HANDLER 7
irq_num_8:   IRQ_NO_ECODE_HANDLER 8
irq_num_9:   IRQ_NO_ECODE_HANDLER 9
irq_num_10:  IRQ_NO_ECODE_HANDLER 10
irq_num_11:  IRQ_NO_ECODE_HANDLER 11
irq_num_12:  IRQ_NO_ECODE_HANDLER 12
irq_num_13:  IRQ_NO_ECODE_HANDLER 13
irq_num_14:  IRQ_NO_ECODE_HANDLER 14
irq_num_15:  IRQ_NO_ECODE_HANDLER 15
irq_num_16:  IRQ_NO_ECODE_HANDLER 16
irq_num_17:  IRQ_NO_ECODE_HANDLER 17
irq_num_18:  IRQ_NO_ECODE_HANDLER 18
irq_num_19:  IRQ_NO_ECODE_HANDLER 19
irq_num_20:  IRQ_NO_ECODE_HANDLER 20
irq_num_21:  IRQ_NO_ECODE_HANDLER 21
irq_num_22:  IRQ_NO_ECODE_HANDLER 22
irq_num_23:  IRQ_NO_ECODE_HANDLER 23
irq_num_24:  IRQ_NO_ECODE_HANDLER 24
irq_num_25:  IRQ_NO_ECODE_HANDLER 25
irq_num_26:  IRQ_NO_ECODE_HANDLER 26
irq_num_27:  IRQ_NO_ECODE_HANDLER 27
irq_num_28:  IRQ_NO_ECODE_HANDLER 28
irq_num_29:  IRQ_NO_ECODE_HANDLER 29
irq_num_30:  IRQ_NO_ECODE_HANDLER 30
irq_num_31:  IRQ_NO_ECODE_HANDLER 31
irq_num_32:  IRQ_NO_ECODE_HANDLER 32
irq_num_33:  IRQ_NO_ECODE_HANDLER 33
irq_num_34:  IRQ_NO_ECODE_HANDLER 34
irq_num_35:  IRQ_NO_ECODE_HANDLER 35
irq_num_36:  IRQ_NO_ECODE_HANDLER 36
irq_num_37:  IRQ_NO_ECODE_HANDLER 37
irq_num_38:  IRQ_NO_ECODE_HANDLER 38
irq_num_39:  IRQ_NO_ECODE_HANDLER 39
irq_num_40:  IRQ_NO_ECODE_HANDLER 40
irq_num_41:  IRQ_NO_ECODE_HANDLER 41
irq_num_42:  IRQ_NO_ECODE_HANDLER 42
irq_num_43:  IRQ_NO_ECODE_HANDLER 43
irq_num_44:  IRQ_NO_ECODE_HANDLER 44
irq_num_45:  IRQ_NO_ECODE_HANDLER 45
irq_num_46:  IRQ_NO_ECODE_HANDLER 46
irq_num_47:  IRQ_NO_ECODE_HANDLER 47
irq_num_48:  IRQ_NO_ECODE_HANDLER 48
irq_num_49:  IRQ_NO_ECODE_HANDLER 49
irq_num_50:  IRQ_NO_ECODE_HANDLER 50
irq_num_51:  IRQ_NO_ECODE_HANDLER 51
irq_num_52:  IRQ_NO_ECODE_HANDLER 52
irq_num_53:  IRQ_NO_ECODE_HANDLER 53
irq_num_54:  IRQ_NO_ECODE_HANDLER 54
irq_num_55:  IRQ_NO_ECODE_HANDLER 55
irq_num_56:  IRQ_NO_ECODE_HANDLER 56
irq_num_57:  IRQ_NO_ECODE_HANDLER 57
irq_num_58:  IRQ_NO_ECODE_HANDLER 58
irq_num_59:  IRQ_NO_ECODE_HANDLER 59
irq_num_60:  IRQ_NO_ECODE_HANDLER 60
irq_num_61:  IRQ_NO_ECODE_HANDLER 61
irq_num_62:  IRQ_NO_ECODE_HANDLER 62
irq_num_63:  IRQ_NO_ECODE_HANDLER 63
irq_num_64:  IRQ_NO_ECODE_HANDLER 64
irq_num_65:  IRQ_NO_ECODE_HANDLER 65
irq_num_66:  IRQ_NO_ECODE_HANDLER 66
irq_num_67:  IRQ_NO_ECODE_HANDLER 67
irq_num_68:  IRQ_NO_ECODE_HANDLER 68
irq_num_69:  IRQ_NO_ECODE_HANDLER 69
irq_num_70:  IRQ_NO_ECODE_HANDLER 70
irq_num_71:  IRQ_NO_ECODE_HANDLER 71
irq_num_72:  IRQ_NO_ECODE_HANDLER 72
irq_num_73:  IRQ_NO_ECODE_HANDLER 73
irq_num_74:  IRQ_NO_ECODE_HANDLER 74
irq_num_75:  IRQ_NO_ECODE_HANDLER 75
irq_num_76:  IRQ_NO_ECODE_HANDLER 76
irq_num_77:  IRQ_NO_ECODE_HANDLER 77
irq_num_78:  IRQ_NO_ECODE_HANDLER 78
irq_num_79:  IRQ_NO_ECODE_HANDLER 79
irq_num_80:  IRQ_NO_ECODE_HANDLER 80
irq_num_81:  IRQ_NO_ECODE_HANDLER 81
irq_num_82:  IRQ_NO_ECODE_HANDLER 82
irq_num_83:  IRQ_NO_ECODE_HANDLER 83
irq_num_84:  IRQ_NO_ECODE_HANDLER 84
irq_num_85:  IRQ_NO_ECODE_HANDLER 85
irq_num_86:  IRQ_NO_ECODE_HANDLER 86
irq_num_87:  IRQ_NO_ECODE_HANDLER 87
irq_num_88:  IRQ_NO_ECODE_HANDLER 88
irq_num_89:  IRQ_NO_ECODE_HANDLER 89
irq_num_90:  IRQ_NO_ECODE_HANDLER 90
irq_num_91:  IRQ_NO_ECODE_HANDLER 91
irq_num_92:  IRQ_NO_ECODE_HANDLER 92
irq_num_93:  IRQ_NO_ECODE_HANDLER 93
irq_num_94:  IRQ_NO_ECODE_HANDLER 94
irq_num_95:  IRQ_NO_ECODE_HANDLER 95
irq_num_96:  IRQ_NO_ECODE_HANDLER 96
irq_num_97:  IRQ_NO_ECODE_HANDLER 97
irq_num_98:  IRQ_NO_ECODE_HANDLER 98
irq_num_99:  IRQ_NO_ECODE_HANDLER 99
irq_num_100:     IRQ_NO_ECODE_HANDLER 100
irq_num_101:     IRQ_NO_ECODE_HANDLER 101
irq_num_102:     IRQ_NO_ECODE_HANDLER 102
irq_num_103:     IRQ_NO_ECODE_HANDLER 103
irq_num_104:     IRQ_NO_ECODE_HANDLER 104
irq_num_105:     IRQ_NO_ECODE_HANDLER 105
irq_num_106:     IRQ_NO_ECODE_HANDLER 106
irq_num_107:     IRQ_NO_ECODE_HANDLER 107
irq_num_108:     IRQ_NO_ECODE_HANDLER 108
irq_num_109:     IRQ_NO_ECODE_HANDLER 109
irq_num_110:     IRQ_NO_ECODE_HANDLER 110
irq_num_111:     IRQ_NO_ECODE_HANDLER 111
irq_num_112:     IRQ_NO_ECODE_HANDLER 112
irq_num_113:     IRQ_NO_ECODE_HANDLER 113
irq_num_114:     IRQ_NO_ECODE_HANDLER 114
irq_num_115:     IRQ_NO_ECODE_HANDLER 115
irq_num_116:     IRQ_NO_ECODE_HANDLER 116
irq_num_117:     IRQ_NO_ECODE_HANDLER 117
irq_num_118:     IRQ_NO_ECODE_HANDLER 118
irq_num_119:     IRQ_NO_ECODE_HANDLER 119
irq_num_120:     IRQ_NO_ECODE_HANDLER 120
irq_num_121:     IRQ_NO_ECODE_HANDLER 121
irq_num_122:     IRQ_NO_ECODE_HANDLER 122
irq_num_123:     IRQ_NO_ECODE_HANDLER 123
irq_num_124:     IRQ_NO_ECODE_HANDLER 124
irq_num_125:     IRQ_NO_ECODE_HANDLER 125
irq_num_126:     IRQ_NO_ECODE_HANDLER 126
irq_num_127:     IRQ_NO_ECODE_HANDLER 127
irq_num_128:     IRQ_NO_ECODE_HANDLER 128
irq_num_129:     IRQ_NO_ECODE_HANDLER 129
irq_num_130:     IRQ_NO_ECODE_HANDLER 130
irq_num_131:     IRQ_NO_ECODE_HANDLER 131
irq_num_132:     IRQ_NO_ECODE_HANDLER 132
irq_num_133:     IRQ_NO_ECODE_HANDLER 133
irq_num_134:     IRQ_NO_ECODE_HANDLER 134
irq_num_135:     IRQ_NO_ECODE_HANDLER 135
irq_num_136:     IRQ_NO_ECODE_HANDLER 136
irq_num_137:     IRQ_NO_ECODE_HANDLER 137
irq_num_138:     IRQ_NO_ECODE_HANDLER 138
irq_num_139:     IRQ_NO_ECODE_HANDLER 139
irq_num_140:     IRQ_NO_ECODE_HANDLER 140
irq_num_141:     IRQ_NO_ECODE_HANDLER 141
irq_num_142:     IRQ_NO_ECODE_HANDLER 142
irq_num_143:     IRQ_NO_ECODE_HANDLER 143
irq_num_144:     IRQ_NO_ECODE_HANDLER 144
irq_num_145:     IRQ_NO_ECODE_HANDLER 145
irq_num_146:     IRQ_NO_ECODE_HANDLER 146
irq_num_147:     IRQ_NO_ECODE_HANDLER 147
irq_num_148:     IRQ_NO_ECODE_HANDLER 148
irq_num_149:     IRQ_NO_ECODE_HANDLER 149
irq_num_150:     IRQ_NO_ECODE_HANDLER 150
irq_num_151:     IRQ_NO_ECODE_HANDLER 151
irq_num_152:     IRQ_NO_ECODE_HANDLER 152
irq_num_153:     IRQ_NO_ECODE_HANDLER 153
irq_num_154:     IRQ_NO_ECODE_HANDLER 154
irq_num_155:     IRQ_NO_ECODE_HANDLER 155
irq_num_156:     IRQ_NO_ECODE_HANDLER 156
irq_num_157:     IRQ_NO_ECODE_HANDLER 157
irq_num_158:     IRQ_NO_ECODE_HANDLER 158
irq_num_159:     IRQ_NO_ECODE_HANDLER 159
irq_num_160:     IRQ_NO_ECODE_HANDLER 160
irq_num_161:     IRQ_NO_ECODE_HANDLER 161
irq_num_162:     IRQ_NO_ECODE_HANDLER 162
irq_num_163:     IRQ_NO_ECODE_HANDLER 163
irq_num_164:     IRQ_NO_ECODE_HANDLER 164
irq_num_165:     IRQ_NO_ECODE_HANDLER 165
irq_num_166:     IRQ_NO_ECODE_HANDLER 166
irq_num_167:     IRQ_NO_ECODE_HANDLER 167
irq_num_168:     IRQ_NO_ECODE_HANDLER 168
irq_num_169:     IRQ_NO_ECODE_HANDLER 169
irq_num_170:     IRQ_NO_ECODE_HANDLER 170
irq_num_171:     IRQ_NO_ECODE_HANDLER 171
irq_num_172:     IRQ_NO_ECODE_HANDLER 172
irq_num_173:     IRQ_NO_ECODE_HANDLER 173
irq_num_174:     IRQ_NO_ECODE_HANDLER 174
irq_num_175:     IRQ_NO_ECODE_HANDLER 175
irq_num_176:     IRQ_NO_ECODE_HANDLER 176
irq_num_177:     IRQ_NO_ECODE_HANDLER 177
irq_num_178:     IRQ_NO_ECODE_HANDLER 178
irq_num_179:     IRQ_NO_ECODE_HANDLER 179
irq_num_180:     IRQ_NO_ECODE_HANDLER 180
irq_num_181:     IRQ_NO_ECODE_HANDLER 181
irq_num_182:     IRQ_NO_ECODE_HANDLER 182
irq_num_183:     IRQ_NO_ECODE_HANDLER 183
irq_num_184:     IRQ_NO_ECODE_HANDLER 184
irq_num_185:     IRQ_NO_ECODE_HANDLER 185
irq_num_186:     IRQ_NO_ECODE_HANDLER 186
irq_num_187:     IRQ_NO_ECODE_HANDLER 187
irq_num_188:     IRQ_NO_ECODE_HANDLER 188
irq_num_189:     IRQ_NO_ECODE_HANDLER 189
irq_num_190:     IRQ_NO_ECODE_HANDLER 190
irq_num_191:     IRQ_NO_ECODE_HANDLER 191
irq_num_192:     IRQ_NO_ECODE_HANDLER 192
irq_num_193:     IRQ_NO_ECODE_HANDLER 193
irq_num_194:     IRQ_NO_ECODE_HANDLER 194
irq_num_195:     IRQ_NO_ECODE_HANDLER 195
irq_num_196:     IRQ_NO_ECODE_HANDLER 196
irq_num_197:     IRQ_NO_ECODE_HANDLER 197
irq_num_198:     IRQ_NO_ECODE_HANDLER 198
irq_num_199:     IRQ_NO_ECODE_HANDLER 199
irq_num_200:     IRQ_NO_ECODE_HANDLER 200
irq_num_201:     IRQ_NO_ECODE_HANDLER 201
irq_num_202:     IRQ_NO_ECODE_HANDLER 202
irq_num_203:     IRQ_NO_ECODE_HANDLER 203
irq_num_204:     IRQ_NO_ECODE_HANDLER 204
irq_num_205:     IRQ_NO_ECODE_HANDLER 205
irq_num_206:     IRQ_NO_ECODE_HANDLER 206
irq_num_207:     IRQ_NO_ECODE_HANDLER 207
irq_num_208:     IRQ_NO_ECODE_HANDLER 208
irq_num_209:     IRQ_NO_ECODE_HANDLER 209
irq_num_210:     IRQ_NO_ECODE_HANDLER 210
irq_num_211:     IRQ_NO_ECODE_HANDLER 211
irq_num_212:     IRQ_NO_ECODE_HANDLER 212
irq_num_213:     IRQ_NO_ECODE_HANDLER 213
irq_num_214:     IRQ_NO_ECODE_HANDLER 214
irq_num_215:     IRQ_NO_ECODE_HANDLER 215
irq_num_216:     IRQ_NO_ECODE_HANDLER 216
irq_num_217:     IRQ_NO_ECODE_HANDLER 217
irq_num_218:     IRQ_NO_ECODE_HANDLER 218
irq_num_219:     IRQ_NO_ECODE_HANDLER 219
irq_num_220:     IRQ_NO_ECODE_HANDLER 220
irq_num_221:     IRQ_NO_ECODE_HANDLER 221
irq_num_222:     IRQ_NO_ECODE_HANDLER 222
irq_num_223:     IRQ_NO_ECODE_HANDLER 223
irq_num_224:     IRQ_NO_ECODE_HANDLER 224
irq_num_225:     IRQ_NO_ECODE_HANDLER 225
irq_num_226:     IRQ_NO_ECODE_HANDLER 226
irq_num_227:     IRQ_NO_ECODE_HANDLER 227
irq_num_228:     IRQ_NO_ECODE_HANDLER 228
irq_num_229:     IRQ_NO_ECODE_HANDLER 229
irq_num_230:     IRQ_NO_ECODE_HANDLER 230
irq_num_231:     IRQ_NO_ECODE_HANDLER 231
irq_num_232:     IRQ_NO_ECODE_HANDLER 232
irq_num_233:     IRQ_NO_ECODE_HANDLER 233
irq_num_234:     IRQ_NO_ECODE_HANDLER 234
irq_num_235:     IRQ_NO_ECODE_HANDLER 235
irq_num_236:     IRQ_NO_ECODE_HANDLER 236
irq_num_237:     IRQ_NO_ECODE_HANDLER 237
irq_num_238:     IRQ_NO_ECODE_HANDLER 238
irq_num_239:     IRQ_NO_ECODE_HANDLER 239
irq_num_240:     IRQ_NO_ECODE_HANDLER 240
irq_num_241:     IRQ_NO_ECODE_HANDLER 241
irq_num_242:     IRQ_NO_ECODE_HANDLER 242
irq_num_243:     IRQ_NO_ECODE_HANDLER 243
irq_num_244:     IRQ_NO_ECODE_HANDLER 244
irq_num_245:     IRQ_NO_ECODE_HANDLER 245
irq_num_246:     IRQ_NO_ECODE_HANDLER 246
irq_num_247:     IRQ_NO_ECODE_HANDLER 247
irq_num_248:     IRQ_NO_ECODE_HANDLER 248
irq_num_249:     IRQ_NO_ECODE_HANDLER 249
irq_num_250:     IRQ_NO_ECODE_HANDLER 250
irq_num_251:     IRQ_NO_ECODE_HANDLER 251
irq_num_252:     IRQ_NO_ECODE_HANDLER 252
irq_num_253:     IRQ_NO_ECODE_HANDLER 253
irq_num_254:     IRQ_NO_ECODE_HANDLER 254
irq_num_255:     IRQ_NO_ECODE_HANDLER 255

